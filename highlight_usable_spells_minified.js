const preparedColor="green",usedColor="#AA7A00",grayedOutColor="#333333",unversalDropdownValue="All";var spellButtons=document.querySelectorAll('button[name="roll_spellroll"]');function createToggle(e,t,l=!1){let n=document.createElement("label");n.className="spellsectiontoggles-row";document.querySelector('div[class="spellsectiontoggles background-color"]').appendChild(n);let r=document.createElement("span");r.className="checkbox",n.appendChild(r);let o=document.createElement("label");o.className="switch",o.setAttribute("title",e),r.appendChild(o);let s=document.createElement("input");s.type="checkbox",s.checked=l,s.addEventListener("change",t),o.appendChild(s);let a=document.createElement("span");a.className="slider",o.appendChild(a);let c=document.createElement("span");c.innerHTML=e,c.setAttribute("data-i18n",e),n.appendChild(c)}function createDropdown(e,t){let l=document.createElement("label");l.className="spellsectiontoggles-row";document.querySelector('div[class="spellsectiontoggles background-color"]').appendChild(l);let n=document.createElement("span");l.appendChild(n);let r=document.createElement("label");r.className="switch",r.setAttribute("title",e),n.appendChild(r);let o=getOptionsForDropdownTitle(t),s=document.createElement("select");s.className="simple",s.name="custom-dropdown";for(let a=0;a<o.length;a++){let c=document.createElement("option");c.value=o[a],c.innerHTML=o[a],s.appendChild(c)}s.addEventListener("change",function(){hideByDropdown(this.value,t)}),r.appendChild(s);var u=document.createElement("span");u.innerHTML=e,u.setAttribute("data-i18n",e),l.appendChild(u)}function getOptionsForDropdownTitle(e){return["All"].concat([...document.querySelector('select[title="'+e+'"]').options].map(e=>e.value))}function hideByDropdown(e,t){for(i=0;i<spellButtons.length;i++){let l=spellButtons[i].parentElement,n=l.querySelector('span[name="attr_name"]');if("All"==e){l.style.visibility="visible";continue}if(n.innerHTML.includes("---"))continue;let r=l.querySelector('select[title="'+t+'"]');l.style.visibility="visible",null!=r&&r.value!=e&&(l.style.visibility="hidden")}}function toggleHighlightPreparedSpells(e){let t=e.currentTarget.checked;for(i=0;i<spellButtons.length;i++){let l=spellButtons[i].parentElement,n=l.querySelector('span[name="attr_name"]');if(!1==t){spellButtons[i].removeAttribute("style");continue}if(n.innerHTML.includes("---")){spellButtons[i].style.backgroundColor="black";continue}let r=l.querySelector('input[name="attr_uses"]'),o=l.querySelector('input[name="attr_uses_max"]');if(null==r){let s=document.querySelector('input[name="attr_focus_points"]');null!=s&&s.value>0?spellButtons[i].style.backgroundColor=preparedColor:spellButtons[i].style.backgroundColor=usedColor}else if(r.value>0){if(n.innerHTML.includes("Staff")||n.innerHTML.includes("Mask")||n.innerHTML.includes("Item")||n.innerHTML.includes("Wand")||n.innerHTML.includes("Scroll")){spellButtons[i].style.backgroundColor="darkred";continue}spellButtons[i].style.backgroundColor=preparedColor}else o.value>0?spellButtons[i].style.backgroundColor=usedColor:spellButtons[i].style.backgroundColor="#333333"}}function toggleUnpreparedSpellsVisbility(e){let t=e.currentTarget.checked;for(i=0;i<spellButtons.length;i++){let l=spellButtons[i].parentElement;if(l.querySelector('span[name="attr_name"]').innerHTML.includes("---"))continue;let n=l.querySelector('input[name="attr_uses"]'),r=l.querySelector('input[name="attr_uses_max"]');l.style.visibility="visible",t&&null!=n&&0==n.value&&null!=r&&0==r.value&&(l.style.visibility="hidden")}}function toggleFont(e){let t=e.currentTarget.checked;for(i=0;i<spellButtons.length;i++){let l=spellButtons[i].parentElement.querySelector('span[name="attr_name"]');l.style.textTransform="none",!1==t&&(l.style.textTransform=null)}}createToggle("Highlight",toggleHighlightPreparedSpells),createToggle("Hide",toggleUnpreparedSpellsVisbility),createToggle("Custom Font",toggleFont),createDropdown("Save Type","@{save_type}"),createDropdown("Action","@{cast_actions}");
